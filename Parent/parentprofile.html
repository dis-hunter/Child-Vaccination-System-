<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Profile Page</title>
  <!-- <script src="../Header-Footer/header-footer.js"></script> -->
  <link rel="stylesheet" href="../Header-Footer/Stylesheets/style.css">
  <style>
    body {
  font-family: sans-serif;
  margin: 0;
  padding: 20px;
}

/* Header */
.profile-header {
  display: flex;
  align-items: center;  /* Vertically align items */
  padding: 20px;
  background-color: #40e0d0;
  border-radius: 8px;
  margin: 4%;
}

.profile-info {
  flex-grow: 1;  /* Allow profile info to take up available space */
}

.profile-actions button {
  margin-left: 10px; 
  padding: 8px 12px;
  background-color: #008080; /* Example blue color */
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* Skills Section */
.children ul {
  list-style: none;
  padding-left:10px;
  display: flex;  /* Arrange skills horizontally */
  flex-wrap: wrap; /* Allow wrapping to next line */
}

.children li {
  margin: 5px;
  padding: 8px 12px;
  background-color: #f5f5f5;
  border-radius: 4px;
}

/* Updates Section */
.updates {
  margin-top: 20px;
}

.update {
  background-color: #fff;
  padding: 15px;
  margin-bottom: 10px;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.update p {
  margin-bottom: 5px;
}

.update button {
  /* ... similar styling as profile-actions buttons ... */
}
  </style>
</head>
<body>
    <special-header></special-header>
    <main>
 
    <div class="profile-header">


      <div class="profile-info">
        <!-- parentName -->
        <h1 id="parentName"></h1>    
                               
        <p id="parentEmailAddress"></p>
        <p id="parentPhoneNumber">Parent</p>
        <p id="parentNationalID">Parent</p>

        
        <p>South B, Nairobi</p>
      </div>
      <div class="profile-actions">
        <button>Edit Profile</button>
        <button>Settings</button>
      </div>
    </div>
    <form class="d-flex" role="search" onsubmit="searchBar(); return false;">
      <input class="form-control me-2" type="search" id="searchQuery" placeholder="Enter Parent Name" aria-label="Search">
      <button class="btn btn-outline-success" type="submit">Search</button>
  </form>
  
  
  </div>

  
    <section class="children">
      <h1>Children</h1>
      <a id="childname" href="#">Child Name (Document ID)</a>

      <ul>
        <li>Zawadi</li>
        <li>{{data.childName}}</li>
        <li>Taiyo</li>
      </ul>
    </section>

    <section class="updates">
      
      <div class="update">
        <h2>Messages</h2>
        <p>Receive latest results and reminders on vaccinations to come!</p>
      </div>
      
    </section>
  </main>
  <special-footer></special-footer>
  <script>
    let parentNationalID;
    document.querySelector("form").addEventListener("submit", function (event) {
      event.preventDefault(); // Prevent form from submitting and reloading the page
      searchBar();  // Call your async function
    });

    // async function searchBar() {
    //   // ... (your searchBar function) ...
    // }

    // // Function to dynamically update the DOM with the children
    // function displayChildren(children) {
    //   const childrenList = document.querySelector('.children ul');
    //   childrenList.innerHTML = '';  // Clear the list first

    // // Loop through the children array and create list items for each child
    // children.forEach(child => {
    //   const listItem = document.createElement('li');
    //   listItem.textContent = child.ChildName;  // Assuming each child object has a 'ChildName' property
    //   childrenList.appendChild(listItem);
  //   // });
  // }
async function ParentDetails() {
  
  parent_localId= await getParentDetails()

      try {
        // Use localId in the API URL
        const url = `http://127.0.0.1:5000/parentDetails?ParentlocalID=${encodeURIComponent(parent_localId)}`;

        // Send a GET request to the backend (no body needed for GET requests)
        const response = await fetch(url, {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json', // You can keep headers if needed
          }
        });

        // Process the response
        const data = await response.json();
                                                                                              
          

    if (response.ok) {
      console.log('Children found:', data);  // Log child names in the console
                                                                                //the function for filling the dom is being executed here
      await ParentDomPopulation(data);
    } else {
      console.error('Error fetching child details:', data.error || response.statusText);    }
  } catch (error) {
    console.error('Error:', error);
  }
}
async function getParentDetails()
{
  function getLocalIdFromUrl() {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get('localId'); // Change 'localId' to whatever the parameter name is
    }

    // Extract the localId
    const localId = getLocalIdFromUrl();
    
    if (!localId) {
        console.error("localId not found in URL");
        return; // Exit the function if localId is not found
    }
    console.log(localId);
    return localId;
}
// this function is the one that displays the attributes on the dom
async function ParentDomPopulation(data)
{
  const parentjson = data.parentDetails; // Assuming there's only one child for simplicity
     let parentName= parentjson.parentName;
     let parentEmailAddress=parentjson.parentEmailAddress;
     let parentPhoneNumber=parentjson.parentPhoneNumber;
      parentNationalID=parentjson.parentNationalID;

      //  parentName=parentjson.parentName;                                      //child details
    console.log("parentname", parentjson);
    document.getElementById("parentName").innerHTML=parentName;
    document.getElementById("parentEmailAddress").innerHTML =parentEmailAddress;
    document.getElementById("parentPhoneNumber").innerHTML =parentPhoneNumber;
    document.getElementById("parentNationalID").innerHTML =parentNationalID;
    
      
      
}

    document.addEventListener('DOMContentLoaded', () => {
        ParentDetails(); // Call the function when the DOM is fully loaded
    });

  </script>


</body>
</html>


  